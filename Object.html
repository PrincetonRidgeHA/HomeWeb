<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Object - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">BasicObject
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-2F">#/</a>
    
    <li ><a href="#method-i-2Fadmin-2Fdashboard-2Fdata-2Fcontacts">#/admin/dashboard/data/contacts</a>
    
    <li ><a href="#method-i-2Fadmin-2Fdashboard-2Fdata-2Fdocs">#/admin/dashboard/data/docs</a>
    
    <li ><a href="#method-i-2Fadmin-2Fdashboard-2Fdata-2Fnews">#/admin/dashboard/data/news</a>
    
    <li ><a href="#method-i-2Fadmin-2Fdashboard-2Fdata-2Frd">#/admin/dashboard/data/rd</a>
    
    <li ><a href="#method-i-2Fadmin-2Fdashboard-2Fdata-2Fyom">#/admin/dashboard/data/yom</a>
    
    <li ><a href="#method-i-2Fadmin-2Fdashboard-2Fhome">#/admin/dashboard/home</a>
    
    <li ><a href="#method-i-2Fadmin-2Flogin">#/admin/login</a>
    
    <li ><a href="#method-i-2Fadmin-2Foauth-2Fv2-2Fgithub-2Fcallback">#/admin/oauth/v2/github/callback</a>
    
    <li ><a href="#method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fcontacts-2Fall">#/api/v1/protected/data/contacts/all</a>
    
    <li ><a href="#method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fcontacts-2Fcount">#/api/v1/protected/data/contacts/count</a>
    
    <li ><a href="#method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fdocs-2Fall">#/api/v1/protected/data/docs/all</a>
    
    <li ><a href="#method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fdocs-2Fcount">#/api/v1/protected/data/docs/count</a>
    
    <li ><a href="#method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fresidents-2Fall">#/api/v1/protected/data/residents/all</a>
    
    <li ><a href="#method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fresidents-2Fcount">#/api/v1/protected/data/residents/count</a>
    
    <li ><a href="#method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fyom-2Fall">#/api/v1/protected/data/yom/all</a>
    
    <li ><a href="#method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fyom-2Fcount">#/api/v1/protected/data/yom/count</a>
    
    <li ><a href="#method-i-2Fapi-2Fv1-2Fpublic-2Fversion">#/api/v1/public/version</a>
    
    <li ><a href="#method-i-2Fboard-2Fhome">#/board/home</a>
    
    <li ><a href="#method-i-2Fcontact">#/contact</a>
    
    <li ><a href="#method-i-2Flogin">#/login</a>
    
    <li ><a href="#method-i-2Flogin-2Fsso">#/login/sso</a>
    
    <li ><a href="#method-i-2Flogout-2Fsso">#/logout/sso</a>
    
    <li ><a href="#method-i-2Fnews">#/news</a>
    
    <li ><a href="#method-i-2Fnews-2F-3Aid">#/news/:id</a>
    
    <li ><a href="#method-i-2Fraw-2Fprotected-2Fresidents.csv">#/raw/protected/residents.csv</a>
    
    <li ><a href="#method-i-2Fraw-2Fpublic-2Frss.xml">#/raw/public/rss.xml</a>
    
    <li ><a href="#method-i-2Fsecured-2Fmembers-2Fcontacts">#/secured/members/contacts</a>
    
    <li ><a href="#method-i-2Fsecured-2Fmembers-2Fdocs">#/secured/members/docs</a>
    
    <li ><a href="#method-i-2Fsecured-2Fmembers-2Fhome">#/secured/members/home</a>
    
    <li ><a href="#method-i-2Fsecured-2Fmembers-2Fresidents">#/secured/members/residents</a>
    
    <li ><a href="#method-i-2Fsecured-2Fmembers-2Fyom">#/secured/members/yom</a>
    
    <li ><a href="#method-i-2Ftest-2F-3Akey-2Fresetauth">#/test/:key/resetauth</a>
    
    <li ><a href="#method-i-adminlogin-3F">#adminlogin?</a>
    
    <li ><a href="#method-i-gen_api_key-21">#gen_api_key!</a>
    
    <li ><a href="#method-i-login-3F">#login?</a>
    
    <li ><a href="#method-i-ssologin-3F">#ssologin?</a>
    
    <li ><a href="#method-i-unknown">#unknown</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Object">
  <h1 id="class-Object" class="class">
    class Object
  </h1>

  <section class="description">
    
  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-2F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for home page</p>
          
          

          
          <div class="method-source-code" id="2F-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 77</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-comment"># Transfer all locals to instance variables</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;bootstrap_v3&#39;</span>, <span class="ruby-string">&#39;Home&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/home.css&#39;</span>)
  <span class="ruby-comment"># Retrieve Yard of the Month data</span>
  <span class="ruby-identifier">current_winner</span> = <span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-identifier">month</span><span class="ruby-operator">:</span> <span class="ruby-value">:desc</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">first</span>
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;yom_winner&#39;</span>, <span class="ruby-identifier">current_winner</span>)
  <span class="ruby-comment"># Use generic image if none exists</span>
  <span class="ruby-keyword">if</span>(<span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">get_var</span>(<span class="ruby-string">&#39;yom_winner&#39;</span>).<span class="ruby-identifier">nil?</span>)
    <span class="ruby-identifier">placeholder_data</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">placeholder_data</span>[<span class="ruby-string">&#39;yom_month&#39;</span>] = <span class="ruby-string">&quot;January&quot;</span>
    <span class="ruby-identifier">placeholder_data</span>[<span class="ruby-string">&#39;yom_name&#39;</span>] = <span class="ruby-string">&quot;Null&quot;</span>
    <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;yom_winner&#39;</span>, <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
    
  <span class="ruby-keyword">elsif</span>(<span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">get_var</span>(<span class="ruby-string">&#39;yom_winner&#39;</span>).<span class="ruby-identifier">imgpath</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;#&#39;</span>)
    <span class="ruby-identifier">img_temp</span> = <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">get_var</span>(<span class="ruby-string">&#39;yom_winner&#39;</span>)
    <span class="ruby-identifier">img_temp</span>.<span class="ruby-identifier">imgpath</span> = <span class="ruby-string">&quot;data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==&quot;</span>
    <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;yom_winner&#39;</span>, <span class="ruby-identifier">img_temp</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:home</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fadmin-2Fdashboard-2Fdata-2Fcontacts" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/admin/dashboard/data/contacts</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for admin dashboard contacts data view</p>
          
          

          
          <div class="method-source-code" id="2Fadmin-2Fdashboard-2Fdata-2Fcontacts-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 508</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/admin/dashboard/data/contacts&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/admin/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">adminlogin?</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;metro_v3&#39;</span>, <span class="ruby-string">&#39;Contacts&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/dashboard.css&#39;</span>)
  <span class="ruby-ivar">@admin_uname</span> = <span class="ruby-identifier">session</span>[<span class="ruby-value">:admin_username</span>]
  <span class="ruby-comment"># Data page information</span>
  <span class="ruby-ivar">@yomcount</span> = <span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@rdcount</span> = <span class="ruby-constant">Residents</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@docscount</span> = <span class="ruby-constant">Docs</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@newscount</span> = <span class="ruby-constant">News</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@contactscount</span> = <span class="ruby-constant">Contacts</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-comment"># Page specific data</span>
  <span class="ruby-ivar">@items</span> = <span class="ruby-constant">Contacts</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value">:id</span>)
  <span class="ruby-identifier">gen_api_key!</span>
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;api_key&#39;</span>, <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>])
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:admin_data_contacts</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fadmin-2Fdashboard-2Fdata-2Fdocs" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/admin/dashboard/data/docs</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for admin dashboard document list data view</p>
          
          

          
          <div class="method-source-code" id="2Fadmin-2Fdashboard-2Fdata-2Fdocs-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 396</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/admin/dashboard/data/docs&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/admin/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">adminlogin?</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;metro_v3&#39;</span>, <span class="ruby-string">&#39;Documents&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/dashboard.css&#39;</span>)
  <span class="ruby-ivar">@admin_uname</span> = <span class="ruby-identifier">session</span>[<span class="ruby-value">:admin_username</span>]
  <span class="ruby-comment"># Data page information</span>
  <span class="ruby-ivar">@yomcount</span> = <span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@rdcount</span> = <span class="ruby-constant">Residents</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@docscount</span> = <span class="ruby-constant">Docs</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@newscount</span> = <span class="ruby-constant">News</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@contactscount</span> = <span class="ruby-constant">Contacts</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-comment"># Page specific data</span>
  <span class="ruby-ivar">@items</span> = <span class="ruby-constant">Docs</span>.<span class="ruby-identifier">all</span>
  <span class="ruby-identifier">gen_api_key!</span>
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;api_key&#39;</span>, <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>])
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:admin_data_docs</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fadmin-2Fdashboard-2Fdata-2Fnews" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/admin/dashboard/data/news</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for admin dashboard news listing data view</p>
          
          

          
          <div class="method-source-code" id="2Fadmin-2Fdashboard-2Fdata-2Fnews-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 452</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/admin/dashboard/data/news&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/admin/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">adminlogin?</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;metro_v3&#39;</span>, <span class="ruby-string">&#39;News&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/dashboard.css&#39;</span>)
  <span class="ruby-ivar">@admin_uname</span> = <span class="ruby-identifier">session</span>[<span class="ruby-value">:admin_username</span>]
  <span class="ruby-comment"># Data page information</span>
  <span class="ruby-ivar">@yomcount</span> = <span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@rdcount</span> = <span class="ruby-constant">Residents</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@docscount</span> = <span class="ruby-constant">Docs</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@newscount</span> = <span class="ruby-constant">News</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@contactscount</span> = <span class="ruby-constant">Contacts</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-comment"># Page specific data</span>
  <span class="ruby-ivar">@items</span> = <span class="ruby-constant">News</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value">:id</span>)
  <span class="ruby-identifier">gen_api_key!</span>
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;api_key&#39;</span>, <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>])
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:admin_data_news</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fadmin-2Fdashboard-2Fdata-2Frd" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/admin/dashboard/data/rd</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for admin dashboard resident directory data view</p>
          
          

          
          <div class="method-source-code" id="2Fadmin-2Fdashboard-2Fdata-2Frd-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 340</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/admin/dashboard/data/rd&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/admin/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">adminlogin?</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;metro_v3&#39;</span>, <span class="ruby-string">&#39;Residents&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/dashboard.css&#39;</span>)
  <span class="ruby-ivar">@admin_uname</span> = <span class="ruby-identifier">session</span>[<span class="ruby-value">:admin_username</span>]
  <span class="ruby-comment"># Data page information</span>
  <span class="ruby-ivar">@yomcount</span> = <span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@rdcount</span> = <span class="ruby-constant">Residents</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@docscount</span> = <span class="ruby-constant">Docs</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@newscount</span> = <span class="ruby-constant">News</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@contactscount</span> = <span class="ruby-constant">Contacts</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-comment"># Page specific data</span>
  <span class="ruby-ivar">@items</span> = <span class="ruby-constant">Residents</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value">:name</span>)
  <span class="ruby-identifier">gen_api_key!</span>
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;api_key&#39;</span>, <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>])
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:admin_data_rd</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fadmin-2Fdashboard-2Fdata-2Fyom" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/admin/dashboard/data/yom</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for admin dashboard YOM data view</p>
          
          

          
          <div class="method-source-code" id="2Fadmin-2Fdashboard-2Fdata-2Fyom-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 283</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/admin/dashboard/data/yom&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/admin/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">adminlogin?</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;metro_v3&#39;</span>, <span class="ruby-string">&#39;Dashboard&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/dashboard.css&#39;</span>)
  <span class="ruby-ivar">@admin_uname</span> = <span class="ruby-identifier">session</span>[<span class="ruby-value">:admin_username</span>]
  <span class="ruby-comment"># Data page information</span>
  <span class="ruby-ivar">@yomcount</span> = <span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@rdcount</span> = <span class="ruby-constant">Residents</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@docscount</span> = <span class="ruby-constant">Docs</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@newscount</span> = <span class="ruby-constant">News</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@contactscount</span> = <span class="ruby-constant">Contacts</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-comment"># Page specific data</span>
  <span class="ruby-ivar">@items</span> = <span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value">:id</span>)
  <span class="ruby-identifier">gen_api_key!</span>
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;api_key&#39;</span>, <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>])
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:admin_data_yom</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fadmin-2Fdashboard-2Fhome" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/admin/dashboard/home</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for admin dashboard home</p>
          
          

          
          <div class="method-source-code" id="2Fadmin-2Fdashboard-2Fhome-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 272</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/admin/dashboard/home&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/admin/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">adminlogin?</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;metro_v3&#39;</span>, <span class="ruby-string">&#39;Dashboard&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/dashboard.css&#39;</span>)
  <span class="ruby-ivar">@admin_uname</span> = <span class="ruby-identifier">session</span>[<span class="ruby-value">:admin_username</span>]
  <span class="ruby-identifier">gen_api_key!</span>
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;api_key&#39;</span>, <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>])
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:admin_dashboard</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fadmin-2Flogin" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/admin/login</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for admin login</p>
          
          

          
          <div class="method-source-code" id="2Fadmin-2Flogin-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 234</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/admin/login&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">if</span>(<span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;RACK_ENV&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;development&#39;</span>)
    <span class="ruby-identifier">redirect</span> <span class="ruby-string">&quot;/admin/dashboard/home&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;metro_v3&#39;</span>, <span class="ruby-string">&#39;Administrator Login&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/login.css&#39;</span>)
  <span class="ruby-ivar">@gitid</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;GITHUB_CLIENT_ID&#39;</span>]
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:admin_login</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fadmin-2Foauth-2Fv2-2Fgithub-2Fcallback" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/admin/oauth/v2/github/callback</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for OAuth logins</p>

<p>Normally only called by GitHub API after &#39;/admin/login&#39; redirect</p>
          
          

          
          <div class="method-source-code" id="2Fadmin-2Foauth-2Fv2-2Fgithub-2Fcallback-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 247</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/admin/oauth/v2/github/callback&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-comment"># get temporary GitHub code...</span>
  <span class="ruby-identifier">session_code</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;rack.request.query_hash&#39;</span>][<span class="ruby-string">&#39;code&#39;</span>]

  <span class="ruby-comment"># ... and POST it back to GitHub</span>
  <span class="ruby-identifier">result</span> = <span class="ruby-constant">RestClient</span>.<span class="ruby-identifier">post</span>(<span class="ruby-string">&#39;https://github.com/login/oauth/access_token&#39;</span>,
                          {<span class="ruby-value">:client_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;GITHUB_CLIENT_ID&#39;</span>],
                           <span class="ruby-value">:client_secret</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;GITHUB_CLIENT_SECRET&#39;</span>],
                           <span class="ruby-value">:code</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">session_code</span>},
                           <span class="ruby-value">:accept</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:json</span>)

  <span class="ruby-comment"># extract the token and granted scopes</span>
  <span class="ruby-identifier">access_token</span> = <span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">result</span>)[<span class="ruby-string">&#39;access_token&#39;</span>]
  <span class="ruby-identifier">auth_result</span> = <span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-constant">RestClient</span>.<span class="ruby-identifier">get</span>(<span class="ruby-string">&#39;https://api.github.com/user&#39;</span>,
                                        {<span class="ruby-value">:params</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:access_token</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">access_token</span>}}))
  <span class="ruby-identifier">session</span>[<span class="ruby-value">:adminauth</span>] = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">session</span>[<span class="ruby-value">:adminkey</span>] = <span class="ruby-identifier">access_token</span>
  <span class="ruby-identifier">session</span>[<span class="ruby-value">:admin_username</span>] = <span class="ruby-identifier">auth_result</span>[<span class="ruby-string">&#39;login&#39;</span>]
  <span class="ruby-identifier">session</span>[<span class="ruby-value">:admin_profilepic</span>] = <span class="ruby-identifier">auth_result</span>[<span class="ruby-string">&#39;avatar_url&#39;</span>]
  <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-string">&quot;Welcome back &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:admin_username</span>]
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/admin/dashboard/home&#39;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fcontacts-2Fall" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/api/v1/protected/data/contacts/all</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a paginated list of contacts</p>
          
          

          
          <div class="method-source-code" id="2Fapi-2Fv1-2Fprotected-2Fdata-2Fcontacts-2Fall-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 643</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/api/v1/protected/data/contacts/all&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;Invalid key&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;key&#39;</span>]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;format&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;json&#39;</span>
    <span class="ruby-identifier">content_type</span> <span class="ruby-value">:json</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;page&#39;</span>].<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Contacts</span>.<span class="ruby-identifier">count</span>, <span class="ruby-value">1</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Contacts</span>.<span class="ruby-identifier">count</span>, <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;page&#39;</span>])
    <span class="ruby-keyword">end</span>
    <span class="ruby-constant">Contacts</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value">:id</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-value">10</span>).<span class="ruby-identifier">offset</span>(<span class="ruby-identifier">pagination</span>.<span class="ruby-identifier">get_start_index</span>).<span class="ruby-identifier">to_json</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fcontacts-2Fcount" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/api/v1/protected/data/contacts/count</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets the number of contacts in the database</p>
          
          

          
          <div class="method-source-code" id="2Fapi-2Fv1-2Fprotected-2Fdata-2Fcontacts-2Fcount-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 657</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/api/v1/protected/data/contacts/count&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;401&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;key&#39;</span>]
  { <span class="ruby-value">:count</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Contacts</span>.<span class="ruby-identifier">count</span> }.<span class="ruby-identifier">to_json</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fdocs-2Fall" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/api/v1/protected/data/docs/all</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a paginated list of documents</p>
          
          

          
          <div class="method-source-code" id="2Fapi-2Fv1-2Fprotected-2Fdata-2Fdocs-2Fall-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 603</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/api/v1/protected/data/docs/all&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;Invalid key&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;key&#39;</span>]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;format&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;json&#39;</span>
    <span class="ruby-identifier">content_type</span> <span class="ruby-value">:json</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;page&#39;</span>].<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Docs</span>.<span class="ruby-identifier">count</span>, <span class="ruby-value">1</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Docs</span>.<span class="ruby-identifier">count</span>, <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;page&#39;</span>])
    <span class="ruby-keyword">end</span>
    <span class="ruby-constant">Docs</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value">:uploaddate</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-value">10</span>).<span class="ruby-identifier">offset</span>(<span class="ruby-identifier">pagination</span>.<span class="ruby-identifier">get_start_index</span>).<span class="ruby-identifier">to_json</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fdocs-2Fcount" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/api/v1/protected/data/docs/count</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets the number of documents in the database</p>
          
          

          
          <div class="method-source-code" id="2Fapi-2Fv1-2Fprotected-2Fdata-2Fdocs-2Fcount-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 617</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/api/v1/protected/data/docs/count&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;401&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;key&#39;</span>]
  { <span class="ruby-value">:count</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Docs</span>.<span class="ruby-identifier">count</span> }.<span class="ruby-identifier">to_json</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fresidents-2Fall" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/api/v1/protected/data/residents/all</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a paginated list of residents</p>
          
          

          
          <div class="method-source-code" id="2Fapi-2Fv1-2Fprotected-2Fdata-2Fresidents-2Fall-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 583</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/api/v1/protected/data/residents/all&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;Invalid key&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;key&#39;</span>]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;format&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;json&#39;</span>
    <span class="ruby-identifier">content_type</span> <span class="ruby-value">:json</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;page&#39;</span>].<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Residents</span>.<span class="ruby-identifier">count</span>, <span class="ruby-value">1</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Residents</span>.<span class="ruby-identifier">count</span>, <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;page&#39;</span>])
    <span class="ruby-keyword">end</span>
    <span class="ruby-constant">Residents</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value">:name</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-value">10</span>).<span class="ruby-identifier">offset</span>(<span class="ruby-identifier">pagination</span>.<span class="ruby-identifier">get_start_index</span>).<span class="ruby-identifier">to_json</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fresidents-2Fcount" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/api/v1/protected/data/residents/count</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets the number of residents in the database</p>
          
          

          
          <div class="method-source-code" id="2Fapi-2Fv1-2Fprotected-2Fdata-2Fresidents-2Fcount-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 597</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/api/v1/protected/data/residents/count&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;401&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;key&#39;</span>]
  { <span class="ruby-value">:count</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Residents</span>.<span class="ruby-identifier">count</span> }.<span class="ruby-identifier">to_json</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fyom-2Fall" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/api/v1/protected/data/yom/all</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a paginated list of YOM winners</p>
          
          

          
          <div class="method-source-code" id="2Fapi-2Fv1-2Fprotected-2Fdata-2Fyom-2Fall-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 623</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/api/v1/protected/data/yom/all&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;Invalid key&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;key&#39;</span>]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;format&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;json&#39;</span>
    <span class="ruby-identifier">content_type</span> <span class="ruby-value">:json</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;page&#39;</span>].<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">count</span>, <span class="ruby-value">1</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">count</span>, <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;page&#39;</span>])
    <span class="ruby-keyword">end</span>
    <span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value">:id</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-value">10</span>).<span class="ruby-identifier">offset</span>(<span class="ruby-identifier">pagination</span>.<span class="ruby-identifier">get_start_index</span>).<span class="ruby-identifier">to_json</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fapi-2Fv1-2Fprotected-2Fdata-2Fyom-2Fcount" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/api/v1/protected/data/yom/count</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets the number of YOM winners in the database</p>
          
          

          
          <div class="method-source-code" id="2Fapi-2Fv1-2Fprotected-2Fdata-2Fyom-2Fcount-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 637</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/api/v1/protected/data/yom/count&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;401&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;key&#39;</span>]
  { <span class="ruby-value">:count</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">count</span> }.<span class="ruby-identifier">to_json</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fapi-2Fv1-2Fpublic-2Fversion" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/api/v1/public/version</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Version info for API route</p>
          
          

          
          <div class="method-source-code" id="2Fapi-2Fv1-2Fpublic-2Fversion-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 578</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/api/v1/public/version&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-string">&quot;Keylime Core v1.0. Copyright Joshua Zenn 2016 under the GPL v2 License.&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fboard-2Fhome" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/board/home</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets the home page for the Board Members area</p>
          
          

          
          <div class="method-source-code" id="2Fboard-2Fhome-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 691</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/board/home&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/login/sso?redir=/board/home&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">ssologin?</span>
  <span class="ruby-string">&#39;You are logged in as &#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:sso_auth_username</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fcontact" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/contact</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for contact page</p>
          
          

          
          <div class="method-source-code" id="2Fcontact-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 100</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/contact&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;bootstrap_v3&#39;</span>, <span class="ruby-string">&quot;Contact&quot;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:bugreport</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Flogin" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/login</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for login page</p>
          
          

          
          <div class="method-source-code" id="2Flogin-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 114</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/login&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;bootstrap_v3&#39;</span>, <span class="ruby-string">&#39;Login&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/login.css&#39;</span>)
  <span class="ruby-keyword">if</span>(<span class="ruby-identifier">session</span>[<span class="ruby-value">:authtries</span>].<span class="ruby-identifier">nil?</span>)
    <span class="ruby-identifier">session</span>[<span class="ruby-value">:authtries</span>] = <span class="ruby-value">0</span>
    <span class="ruby-identifier">slim</span> <span class="ruby-value">:login</span>
  <span class="ruby-keyword">elsif</span>(<span class="ruby-identifier">session</span>[<span class="ruby-value">:authtries</span>] <span class="ruby-operator">&lt;=</span> <span class="ruby-value">3</span>)
    <span class="ruby-identifier">slim</span> <span class="ruby-value">:login</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@errdetail</span> = <span class="ruby-string">&#39;0x1&#39;</span>
    <span class="ruby-identifier">slim</span> <span class="ruby-value">:error</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Flogin-2Fsso" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/login/sso</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets the login page for SSO-based accounts</p>
          
          

          
          <div class="method-source-code" id="2Flogin-2Fsso-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 663</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/login/sso&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">ssologin?</span>
    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;redir&#39;</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;metro_v3&#39;</span>, <span class="ruby-string">&#39;SSO Login&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/login.css&#39;</span>)
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:sso_login</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Flogout-2Fsso" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/logout/sso</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Logs the current SSO-based user out</p>
          
          

          
          <div class="method-source-code" id="2Flogout-2Fsso-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 685</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/logout/sso&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">session</span>[<span class="ruby-value">:sso_auth</span>] = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/&#39;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fnews" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/news</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for news feed page</p>
          
          

          
          <div class="method-source-code" id="2Fnews-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 157</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/news&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">articles</span> = <span class="ruby-constant">News</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-identifier">uploaddate</span><span class="ruby-operator">:</span> <span class="ruby-value">:desc</span>)
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;bootstrap_v3&#39;</span>, <span class="ruby-string">&#39;News&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/home.css&#39;</span>)
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;articles&#39;</span>, <span class="ruby-identifier">articles</span>)
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:news</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fnews-2F-3Aid" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/news/:id</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for specific news article</p>
          
          

          
          <div class="method-source-code" id="2Fnews-2F-3Aid-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 148</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/news/:id&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">article</span> = <span class="ruby-constant">News</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;bootstrap_v3&#39;</span>, <span class="ruby-identifier">article</span>.<span class="ruby-identifier">title</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39; - News&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/home.css&#39;</span>)
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;article&#39;</span>, <span class="ruby-identifier">article</span>)
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:news_article</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fraw-2Fprotected-2Fresidents.csv" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/raw/protected/residents.csv</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for CSV file output of allowed data structures</p>
          
          

          
          <div class="method-source-code" id="2Fraw-2Fprotected-2Fresidents.csv-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 563</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/raw/protected/residents.csv&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">login?</span>
  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;content_type&#39;</span>] = <span class="ruby-string">&quot;application/octet-stream&quot;</span>
  <span class="ruby-identifier">attachment</span>(<span class="ruby-string">&#39;residents.csv&#39;</span>)
  <span class="ruby-identifier">item</span> = <span class="ruby-constant">Residents</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value">:name</span>)
  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">item</span>.<span class="ruby-identifier">as_csv</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fraw-2Fpublic-2Frss.xml" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/raw/public/rss.xml</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an XML formatted news feed (no-auth)</p>
          
          

          
          <div class="method-source-code" id="2Fraw-2Fpublic-2Frss.xml-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 572</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/raw/public/rss.xml&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-ivar">@posts</span> = <span class="ruby-constant">News</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">order</span>(<span class="ruby-value">:uploaddate</span>)
  <span class="ruby-identifier">builder</span> <span class="ruby-value">:rss</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fsecured-2Fmembers-2Fcontacts" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/secured/members/contacts</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for contacts page of members dashboard</p>
          
          

          
          <div class="method-source-code" id="2Fsecured-2Fmembers-2Fcontacts-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 222</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/secured/members/contacts&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">login?</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;bootstrap_v3&#39;</span>, <span class="ruby-string">&#39;Contacts&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/dashboard.css&#39;</span>)
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_js_url</span>(<span class="ruby-string">&#39;/src/js/member/datahandler.js&#39;</span>)
  <span class="ruby-identifier">gen_api_key!</span>
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;api_key&#39;</span>, <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>])
  <span class="ruby-ivar">@pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Contacts</span>.<span class="ruby-identifier">count</span>, <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;pg&#39;</span>])
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:member_contacts</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fsecured-2Fmembers-2Fdocs" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/secured/members/docs</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for documents list of members dashboard</p>
          
          

          
          <div class="method-source-code" id="2Fsecured-2Fmembers-2Fdocs-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 198</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/secured/members/docs&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">login?</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;bootstrap_v3&#39;</span>, <span class="ruby-string">&#39;Documents&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/dashboard.css&#39;</span>)
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_js_url</span>(<span class="ruby-string">&#39;/src/js/member/datahandler.js&#39;</span>)
  <span class="ruby-identifier">gen_api_key!</span>
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;api_key&#39;</span>, <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>])
  <span class="ruby-ivar">@pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Docs</span>.<span class="ruby-identifier">count</span>, <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;pg&#39;</span>])
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:member_docs</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fsecured-2Fmembers-2Fhome" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/secured/members/home</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for home page of members dashboard</p>
          
          

          
          <div class="method-source-code" id="2Fsecured-2Fmembers-2Fhome-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 176</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/secured/members/home&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">login?</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;bootstrap_v3&#39;</span>, <span class="ruby-string">&#39;Members Dashboard&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/dashboard.css&#39;</span>)
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:member_home</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fsecured-2Fmembers-2Fresidents" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/secured/members/residents</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for resident directory of members dashboard</p>
          
          

          
          <div class="method-source-code" id="2Fsecured-2Fmembers-2Fresidents-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 184</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/secured/members/residents&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">login?</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;bootstrap_v3&#39;</span>, <span class="ruby-string">&#39;Resident Directory&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/dashboard.css&#39;</span>)
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_js_url</span>(<span class="ruby-string">&#39;/src/js/member/residents/disclaimer.js&#39;</span>)
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_js_url</span>(<span class="ruby-string">&#39;/src/js/member/datahandler.js&#39;</span>)
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_js_url</span>(<span class="ruby-string">&#39;//cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.4.0/bootbox.min.js&#39;</span>)
  <span class="ruby-identifier">gen_api_key!</span>
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;api_key&#39;</span>, <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>])
  <span class="ruby-ivar">@pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Residents</span>.<span class="ruby-identifier">count</span>, <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;pg&#39;</span>])
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:member_directory</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Fsecured-2Fmembers-2Fyom" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/secured/members/yom</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for YOM winners of members dashboard</p>
          
          

          
          <div class="method-source-code" id="2Fsecured-2Fmembers-2Fyom-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 210</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/secured/members/yom&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/login&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">login?</span>
  <span class="ruby-ivar">@view_data</span> = <span class="ruby-constant">ViewData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;bootstrap_v3&#39;</span>, <span class="ruby-string">&#39;Yard of the Month&#39;</span>, <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>])
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_css_url</span>(<span class="ruby-string">&#39;/src/css/admin/dashboard.css&#39;</span>)
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">add_js_url</span>(<span class="ruby-string">&#39;/src/js/member/datahandler.js&#39;</span>)
  <span class="ruby-identifier">gen_api_key!</span>
  <span class="ruby-ivar">@view_data</span>.<span class="ruby-identifier">set_var</span>(<span class="ruby-string">&#39;api_key&#39;</span>, <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>])
  <span class="ruby-ivar">@pagination</span> = <span class="ruby-constant">Pagination</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Yardwinners</span>.<span class="ruby-identifier">count</span>, <span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;pg&#39;</span>])
  <span class="ruby-identifier">slim</span> <span class="ruby-value">:member_yom</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-2Ftest-2F-3Akey-2Fresetauth" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">/test/:key/resetauth</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Route handler for resetting login block (RACK_ENV:TEST only!)</p>
          
          

          
          <div class="method-source-code" id="2Ftest-2F-3Akey-2Fresetauth-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 166</span>
<span class="ruby-identifier">get</span> <span class="ruby-string">&#39;/test/:key/resetauth&#39;</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">if</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:key</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;PRHAKEY&#39;</span>)
    <span class="ruby-identifier">session</span>[<span class="ruby-value">:authtries</span>] = <span class="ruby-value">0</span>
    <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/&#39;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">redirect</span> <span class="ruby-string">&#39;/&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-adminlogin-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">adminlogin?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Defines if current user is logged in through OAuth GitHub gateway</p>
          
          

          
          <div class="method-source-code" id="adminlogin-3F-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 49</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">adminlogin?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;CI&#39;</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;RACK_ENV&#39;</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;development&#39;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:adminauth</span>].<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-gen_api_key-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">gen_api_key!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Generates a new session key to use for verifying API calls</p>
          
          

          
          <div class="method-source-code" id="gen_api_key-21-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 71</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">gen_api_key!</span>
  <span class="ruby-identifier">session</span>[<span class="ruby-value">:apikey</span>] = <span class="ruby-constant">SecureRandom</span>.<span class="ruby-identifier">urlsafe_base64</span>(<span class="ruby-value">25</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-login-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">login?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Defines if current user is logged in</p>
          
          

          
          <div class="method-source-code" id="login-3F-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 38</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">login?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;CI&#39;</span>]
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">session</span>[<span class="ruby-value">:authusr</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">session</span>[<span class="ruby-value">:sso_auth</span>].<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-ssologin-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ssologin?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Defines if current user is logged in as an SSO-based account</p>
          
          

          
          <div class="method-source-code" id="ssologin-3F-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 60</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ssologin?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;CI&#39;</span>]
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">session</span>[<span class="ruby-value">:sso_auth</span>].<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-unknown" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">unknown</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Catch-all 404 error handler</p>
          
          

          
          <div class="method-source-code" id="unknown-source">
            <pre><span class="ruby-comment"># File frontend/main.rb, line 712</span>
<span class="ruby-identifier">not_found</span> <span class="ruby-keyword">do</span>
</pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.1.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

